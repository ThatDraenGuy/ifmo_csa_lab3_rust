# ะะฐะฑะพัะฐัะพัะฝะฐั ัะฐะฑะพัะฐ โ3 ะฟะพ "ะััะธัะตะบัััะต ะบะพะผะฟัััะตัะฐ" - ๐ฆ Rust edition ๐ฆ
**ะฅะฐะนะบะธะฝ ะะปะตะณ ะะณะพัะตะฒะธั, P33312**  
ะะฐัะธะฐะฝั - asm | cisc | neum | hw | tick | struct | stream | port | pstr | prob2 | \[4\]char
## ะะฐะทะฑะพั ััััะบัััั ัะตะฟะพะทะธัะพัะธั
ะะตัะฐะปะธ ะพ ััััะบัััะต ัะตะฟะพะทะธัะพัะธั ะผะพะถะฝะพ ะฟัะพัะธัะฐัั [ะทะดะตัั](./template.md)

## ะฏะทัะบ ะฟัะพะณัะฐะผะผะธัะพะฒะฐะฝะธั
```
program ::= terms

terms ::= term
        | terms term

term ::= instruction
       | label_def
       | directive


instruction ::= math_op
              | branch_op
              | alter_op
              | io_op
              | control_op
              | stack_op

math_op ::= math_opcode math_args
math_opcode ::= 'mov'
              | 'add'
              | 'sub'
              | 'cmp'
              | 'shl'
              | 'shr'

math_args ::= reg_id ',' reg_id
            | mem_by_reg_id ',' reg_id
            | reg_id ',' mem_by_reg_id
            | reg_id ',' label_ref
            | label_ref ',' reg_id
            | reg_id ',' immed


branch_op ::= branch_opcode branch_args
branch_opcode ::= 'jmp'
                | 'jz'
                | 'jnz'
                | 'js'
                | 'jns'
branch_args ::= label_ref


alter_op ::= alter_opcode alter_args
alter_opcode ::= 'inc'
               | 'dec'
alter_args ::= reg_id


io_op ::= io_opcode io_args
io_opcode ::= 'in'
            | 'out'
io_args ::= port_id


control_op ::= 'exit'
             | 'div'


stack_op ::= 'ret'
           | 'call' label_ref
           | 'pop' reg_id
           | 'push' push_args
push_args ::= reg_id
            | immed


mem_by_reg_id ::= '[' reg_id ']'
reg_id ::= 'eax'
         | 'ebx'
         | 'ecx'
         | 'edx'
         | 'esp'
         | 'eip'

immed ::= u32
        | i32
        | symbol
port_id ::= u16

directive ::= "word" literal
literal ::= immed
          | string
string ::= \"(\\.|[^\"])*\"

label_ref ::= label_id
label_def ::= label_id ':'
label_id ::= <combination of any english lowercase letter, number or undeerscore>
```

ะกะฟะพัะพะฑั ะฒัะดะตะปะตะฝะธั ะฟะฐะผััะธ:
- ะกัะฐัะธัะตัะบะธ, ัะตัะตะท ะดะธัะตะบัะธะฒั word
- ะะพะบะฐะปัะฝะพ ะฝะฐ ััะตะบะต (ัะตัะฝะธัะตัะบะธ, ััะพ ะผะพะถะฝะพ ะฝะฐะทะฒะฐัั ะฒัะดะตะปะตะฝะธะตะผ ะฒัััะฝัั ัะตัะตะท ัััะฝะพะน ะฒัะทะพะฒ ะธะฝััััะบัะธะน push/pop ะธะปะธ ัะผะตัะตะฝะธะต ัััะบ-ะฟะพะธะฝัะตัะฐ)

ะะตัะตะผะตะฝะฝัะต ะฝะต ัััะตััะฒััั.

ะ ะบะฐัะตััะฒะต ะปะธัะตัะฐะปะพะฒ (immed-ะทะฝะฐัะตะฝะธะน) ะฟะพะดะดะตัะถะธะฒะฐัััั u32/i32 ัะธัะปะฐ ะธ ะพะดะธะฝะพัะฝัะต ัะธะผะฒะพะปั (char). ะะปั ะดะธัะตะบัะธะฒั word ัะฐะบะถะต ะฟะพะดะดะตัะถะธะฒะฐัััั ัััะพะบะพะฒัะต ะปะธัะตัะฐะปั.


## ะัะณะฐะฝะธะทะฐัะธั ะฟะฐะผััะธ
ะะฐะผััั ะฟัะพัะตััะพัะฐ ะฟัะตะดััะฐะฒะปะตะฝะฐ ะผะฐััะธะฒะพะผ ะธะท ะผะฐัะธะฝะฝัั ัะปะพะฒ. ะะฐะถะดะพะต ะผะฐัะธะฝะฝะพะต ัะปะพะฒะพ ะทะฐะฝะธะผะฐะตั 4 ะฑะฐะนัะฐ. ะกะธััะตะผะฐ ัะฐัััะธัะฐะฝะฐ ะฝะฐ 32-ะฑะธัะฝัะต ะฐะดัะตัะฐ, ะฟะพะดะดะตัะถะธะฒะฐั ะดะพ U32_MAX ััะตะตะบ ะฒ ะฟะฐะผััะธ ะฟัะพัะตััะพัะฐ.

ะกัะพะธั ะพัะผะตัะธัั, ััะพ ัะฐะบะฐั ะฟะฐะผััั ะดะพััะธะณะฐะปะฐ ะฑั 16 ะณะธะณะฐะฑะฐะนั. ะ ัะตะปัั ัะฐะฑะพัั ั ัะธะผัะปััะธะตะน ัะตะฐะปัะฝัะน ัะฐะทะผะตั ะฟะฐะผััะธ ะฑัะป ัะผะตะฝััะตะฝ ะดะพ 4096 ััะตะตะบ. ะะดัะตัะฐัะธั ะฟัะธ ััะพะผ ะฝะต ะธะทะผะตะฝะตะฝะฐ ะธ ัะฟะพัะพะฑะฝะฐ ะฟะพะดะดะตัะถะธะฒะฐัั "ะฟะพะปะฝัั" ะฟะฐะผััั.

ะัะพะฑัะฐะถะตะฝะธะต ะดะฐะฝะฝัั ะธ ะธะฝััััะบัะธะน ะฒ ะฟะฐะผััั ะฟัะธะผะธัะธะฒะฝะฐ - ะฒัะต ะดะฐะฝะฝัะต ะธ ะธะฝััััะบัะธะธ ัะฐัะฟะพะปะฐะณะฐัััั ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพ, ะฝะฐัะธะฝะฐั ั ะฝะฐัะฐะปัะฝะพะน ััะตะนะบะธ ะฟะฐะผััะธ, ะฒ ะฟะพััะดะบะต, ะฒ ะบะพัะพัะพะผ ะพะฝะธ ะฑัะปะธ ะทะฐะดะฐะฝั ั ะธััะพะดะฝะพะผ asm-ะบะพะดะต.

ะัะพะณัะฐะผะผะธััั ะดะพัััะฟะฝั:
- 5 ัะตะณะธัััะพะฒ (Accumulator, Base, Count, Data, Stack Pointer ะธ Instruction Pointer)
- ะะฐะผััั ะฟัะพัะตััะพัะฐ (ะฟัััะผ ัะฐะฑะพัั ั ะผะตัะบะฐะผะธ, ัะตะฐะปัะฝัะผะธ ะฐะดัะตัะฐะผะธ ะธะปะธ ัะบะฐะทะฐัะตะปะตะผ ะฝะฐ ััะตะบ)

ะกัะฐัะธัะตัะบะธะต ะดะฐะฝะฝัะต ัะฐัะฟะพะปะฐะณะฐัััั ะฒ ะฟะฐะผััะธ ะฟัะพัะตััะพัะฐ. ะะธะฝะฐะผะธัะตัะบะธะต ะดะฐะฝะฝัะต ัะฐัะฟะพะปะฐะณะฐะฑััั ะฝะฐ ัััะบะต. ะััะฐ ะฝะต ะฟะพะดะดะตัะถะธะฒะฐะตััั.


## ะกะธััะตะผะฐ ะบะพะผะฐะฝะด
ะะฐัะธะฝะฝะพะต ัะปะพะฒะพ ะทะฐะฝะธะผะฐะตั 4 ะฑะฐะนัะฐ. ะขะธะฟ ะดะฐะฝะฝัั ะพะฟัะตะดะตะปัะตััั ัะพะปัะบะพ ะธะฝัะตัะฟัะตัะฐัะธะตะน ะฟัะพะณัะฐะผะผะธััะฐ - ั ัะพัะบะธ ะทัะตะฝะธั ะฟัะพัะตััะพัะฐ ะฒัั ัะฒะปัะตััั ะฟัะพััะพ ะฝะฐะฑะพัะพะผ ะฑะธั.

ะะตะณะธัััั, ะบะฐะบ ะธ ะผะฐัะธะฝะฝัะต ัะปะพะฒะฐ, ัะฐัััะธัะฐะฝั ะฝะฐ 4 ะฑะฐะนัะฐ (32 ะฑะธัะฐ). 

ะะตะฐะปะธะทะพะฒะฐะฝะฐ ัะพะปัะบะพ ะฟััะผะฐั ะฐะดัะตัะฐัะธั.

ะฃัััะพะนััะฒะฐ ะฒะฒะพะดะฐ-ะฒัะฒะพะดะฐ ะฟะพะดะบะปััะตะฝั ะบ ะฟะพััะฐะผ ะฟัะพัะตััะพัะฐ. ะะพัััะฟ ะบ ะฝะธะผ ะพัััะตััะฒัะปัะตััั ัะตัะตะท id ะฟะพััะฐ. ะกะธััะตะผะฐ ะฟะพะดะดะตัะถะธะฒะฐะตั ะดะพ 2**16 ัะฐะทะปะธัะฝัั ะฟะพััะพะฒ.

ะัะตััะฒะฐะฝะธั ะพััััััะฒััั. ะะพัะพะบ ัะฟัะฐะฒะปะตะฝะธั ัะฟัะฐะฒะปัะตััั ั ะฟะพะผะพััั eip (ัะตะณะธัััะฐ-ัะบะฐะทะฐัะตะปั ะฝะฐ ัะปะตะดััััั ะธะฝััััะบัะธั).

ะะฝััััะบัะธะธ ะทะฐะฝะธะผะฐัั ะพั ะพะดะฝะพะณะพ ะดะพ ะดะฒัั ะผะฐัะธะฝะฝัั ัะปะพะฒ. ะะตะพะฑัะพะดะธะผะพััั ะฒ ะธัะฟะพะปัะทะพะฒะฐะฝะธะธ ะดะฒัั ะผะฐัะธะฝะฝัั ัะปะพะฒ ะดะปั ะพะดะฝะพะน ะธะฝััััะบัะธะธ ะฟะพัะฒะปัะตััั ะธะท-ะทะฐ ัะฐะทะผะตัะฐ immed-ะทะฝะฐัะตะฝะธะน ะธ ะฐะดัะตัะพะฒ (ะพะฑะฐ ะผะพะณัั ะดะพััะธะณะฐัั 4-ัั ะฑะฐะนั, ั.ะต. ัะตะปะพะณะพ ะผะฐัะธะฝะฝะพะณะพ ัะปะพะฒะฐ, ะธะท-ะทะฐ ัะตะณะพ ะผะตััะฐ ะฟะพะด ะบะพะด ะพะฟะตัะฐัะธะธ ะธ ัะธะฟ ะตั ะฐัะณัะผะตะฝัะพะฒ ะฝะต ะพััะฐัััั)

ะะฝััััะบัะธะธ ััะปะพะฒะฝะพ ะดะตะปัััั ะฝะฐ ะฝะตัะบะพะปัะบะพ ะบะฐัะตะณะพัะธะน:

### MathOp
"ะะฐัะตะผะฐัะธัะตัะบะธะต" ะพะฟะตัะฐัะธะธ. ะญัะธ ะธะฝััััะบัะธะธ ะฟัะธะฝะธะผะฐัั 2 ะฐัะณัะผะตะฝัะฐ - dest ะธ src. ะะฝะธ ะฒัะฟะพะปะฝััั ะฝะตะบัั ะพะฟะตัะฐัะธั ะฝะฐะด 2-ะผั ะพะฟะตัะฐะฝะดะฐะผะธ (ะฒะทัััะผะธ ะธะท dest ะธ src ัะพะพัะฒะตัััะฒะตะฝะฝะพ) ะธ ะฟะพะผะตัะฐัั ะทะฝะฐัะตะฝะธะต ะฒ dest. ะะฟะตัะฐะฝะดะฐะผะธ ะผะพะณัั ะฑััั:
- ะฟะฐัะฐ ัะตะณะธัััะพะฒ
- dest - ัะตะณะธััั, src - ะทะฝะฐัะตะฝะธะต ะฒ ะฟะฐะผััะธ ะฟะพ ะฐะดัะตัั ะธะท ัะตะณะธัััะฐ
- dest - ะทะฝะฐัะตะฝะธะต ะฒ ะฟะฐะผััะธ ะฟะพ ะฐะดัะตัั ะธะท ัะตะณะธัััะฐ, src - ัะตะณะธััั
- dest - ัะตะณะธััั, src - ะทะฝะฐัะตะฝะธะต ะฒ ะฟะฐะผััะธ ะฟะพ ะฐะดัะตัั-ะบะพะฝััะฐะฝัะต
- dest - ะทะฝะฐัะตะฝะธะต ะฒ ะฟะฐะผััะธ ะฟะพ ะฐะดัะตัั-ะบะพะฝััะฐะฝัะต, src - ัะตะณะธััั
- dest - ัะตะณะธััั, src - immed-ะทะฝะฐัะตะฝะธะต (ะปะธัะตัะฐะป)

ะ ััะพะน ะบะฐัะตะณะพัะธะธ ัะตะฐะปะธะทะพะฒะฐะฝั ัะปะตะดัััะธะต ะพะฟะตัะฐัะธะธ:
- MOV - ะทะฐะฟะธััะฒะฐะตั ะทะฝะฐัะตะฝะธะต src ะฒ dest
- ADD - ะฟัะธะฑะฐะฒะปัะตั ะทะฝะฐัะตะฝะธะต src ะบ dest
- SUB - ะฒััะธัะฐะตั ะทะฝะฐัะตะฝะธะต src ะธะท dest
- CMP - ะฒััะธัะฐะตั ะทะฝะฐัะตะฝะธะต src ะธะท dest, ะฝะพ ะฝะต ะธะทะผะตะฝัะตั dest, ะฐ ัะพะปัะบะพ ะฒัััะฐะฒะปัะตั ัะปะฐะณะธ
- SHL - ะฐัะธัะผะตัะธัะตัะบะธะน ัะดะฒะธะณ src ะฝะฐ dest ะฑะธั ะฒะปะตะฒะพ
- SHR - ะฐัะธัะผะตัะธัะตัะบะธะน ัะดะฒะธะณ src ะฝะฐ dest ะฑะธั ะฒะฟัะฐะฒะพ

### BranchOp
ะะฟะตัะฐัะธะธ ะฒะตัะฒะปะตะฝะธั. ะะทะผะตะฝััั ะทะฝะฐัะตะฝะธะต eip ะฟัะธ ะฒัะฟะพะปะฝะตะฝะธะธ ะบะฐะบะพะณะพ-ัะพ ััะปะพะฒะธั. ะั ะฐัะณัะผะตะฝัะพะผ ัะฒะปัะตััั ะฐะดัะตั, ะบัะดะฐ ัะพะฒะตััะฐะตััั ะฟะตัะตัะพะด ะฟัะธ ะฒัะฟะพะปะฝะตะฝะธะธ ััะปะพะฒะธั (ะฟัะตะดััะฐะฒะปัะตััั ะผะตัะบะพะน).

ะฃัะปะพะฒะธั ะฟัะตะดััะฐะฒะปะตะฝั ะฟัะพะฒะตัะบะพะน ะทะฝะฐัะตะฝะธั ะบะฐะบะพะณะพ-ัะพ ะธะท ัะปะฐะณะพะฒ ะฟัะพัะตััะพัะฐ. ะะตะฐะปะธะทะพะฒะฐะฝั ะฟะตัะตัะพะดั ะฝะฐ ะพัะฝะพะฒะต ัะปะตะดัััะธั ัะปะฐะณะพะฒ:
- ZF (zero flag) - ัะปะฐะณ, ะพัะพะฑัะฐะถะฐััะธะน ะฝัะปะตะฒะพะต ะทะฝะฐัะตะฝะธะต
- SF (sign flag) - ัะปะฐะณ, ะพัะพะฑัะฐะถะฐััะธะน "ะทะฝะฐะบ" ะทะฝะฐัะตะฝะธั (ะฝะฐะปะธัะธะต ะตะดะธะฝะธัั ะฒ ะตะณะพ ััะฐััะตะผ ะฑะธัะต)

ะ ััะพะน ะบะฐัะตะณะพัะธะธ ัะตะฐะปะธะทะพะฒะฐะฝั ัะปะตะดัััะธะต ะพะฟะตัะฐัะธะธ:
- JMP - ะฑะตะทััะปะพะฒะฝัะน ะฟะตัะตัะพะด
- JZ - ะฟะตัะตัะพะด, ะตัะปะธ ZF=1
- JNZ - ะฟะตัะตัะพะด, ะตัะปะธ ZF=0
- JS - ะฟะตัะตัะพะด, ะตัะปะธ SF=1
- JNS - ะฟะตัะตัะพะด, ะตัะปะธ SF=0

### AlterOp
ะะฟะตัะฐัะธะธ ะฐะปััะตัะฐัะธะธ. ะะทะผะตะฝััั ะทะฝะฐัะตะฝะธะต ัะตะณะธัััะฐ, ะฟะตัะตะดะฐะฝะฝะพะณะพ ะธะผ ะบะฐะบ ะฐัะณัะผะตะฝั.

ะ ััะพะน ะบะฐัะตะณะพัะธะธ ัะตะฐะปะธะทะพะฒะฐะฝั ัะปะตะดัััะธะต ะพะฟะตัะฐัะธะธ:
- INC - ะธะฝะบัะตะผะตะฝั ัะตะณะธัััะฐ
- DEC - ะดะตะบัะตะผะตะฝั ัะตะณะธัััะฐ

### IoOp
ะะฟะตัะฐัะธะธ ะฒะฒะพะดะฐ-ะฒัะฒะพะดะฐ. ะัะธะฝะธะผะฐัั ะฒ ะบะฐัะตััะฒะต ะฐัะณัะผะตะฝัะฐ id ะฟะพััะฐ, ะบ ะบะพัะพัะผั ะฟะพะดะบะปััะตะฝะพ ััััะพะนััะฒะพ. ะัะฟะพะปะฝััั ะฒะฒะพะด/ะฒัะฒะพะด ะผะตะถะดั ะฒัะฑัะฐะฝะฝัะผ ััััะพะนััะฒะพะผ ะธ ะผะปะฐะดัะธะผ ะฑะฐะนัะพะผ ะฐะบะบัะผัะปััะพัะฐ.

ะ ััะพะน ะบะฐัะตะณะพัะธะธ ัะตะฐะปะธะทะพะฒะฐะฝั ัะปะตะดัััะธะต ะพะฟะตัะฐัะธะธ:
- IN - ััะตะฝะธะต ะฑะฐะนัะฐ ะธะท ััััะพะนััะฒะฐ ะฒ ะผะปะฐะดัะธะน ะฑะฐะนั ะฐะบะบัะผัะปััะพัะฐ
- OUT - ะทะฐะฟะธัั ะฑะฐะนัะฐ ะธะท ะผะปะฐะดัะตะณะพ ะฑะฐะนัะฐ ะฐะบะบัะผัะปััะพัะฐ ะฒ ััััะพะนััะฒะพ

### ControlOp
ะะฟะตัะฐัะธะธ ัะฟัะฐะฒะปะตะฝะธั. ะะต ะฟัะธะฝะธะผะฐัั ะฐัะณัะผะตะฝัะพะฒ ะธ ะฒัะฟะพะปะฝััั ะบะฐะบัั-ัะพ "ะพัะพะฑัั" ะพะฟะตัะฐัะธั.

ะ ััะพะน ะบะฐัะตะณะพัะธะธ ัะตะฐะปะธะทะพะฒะฐะฝั ัะปะตะดัััะธะต ะพะฟะตัะฐัะธะธ:
- EXIT - ะฒัะฟะพะปะฝัะตั ะทะฐะฒะตััะตะฝะธะต ัะฐะฑะพัั ะฟัะพัะตััะพัะฐ
- DIV - ะฒัะฟะพะปะฝัะตั ะดะตะปะตะฝะธะต ะทะฝะฐัะตะฝะธั ะฒ ะฐะบะบัะผัะปััะพัะต ะฝะฐ ะทะฝะฐัะตะฝะธะต ะธะท base-ัะตะณะธัััะฐ. ะะพะผะตัะฐะตั ัะฐััะฝะพะต ะฒ ะฐะบะบัะผัะปััะพั ะธ ะพััะฐัะพะบ ะฒ ะดะฐัะฐ-ัะตะณะธััั.

### StackOp
ะะฟะตัะฐัะธะธ ัะฐะฑะพัั ัะพ ััะตะบะพะผ. ะะผะตัั ัะฐะทะฝัะน ะฝะฐะฑะพั ะฐัะณัะผะตะฝัะพะฒ ะธ ะพะฑัะตะดะธะฝะตะฝั ะฒ ะบะฐัะตะณะพัะธั ัะพะปัะบะพ ะฟะพ ัะผััะปั.

ะกัะตะบ ัะตะฐะปะธะทะพะฒะฐะฝ ะฝะฐ ะพัะฝะพะฒะต esp-ัะตะณะธัััะฐ (ัะบะฐะทะฐัะตะปั ะฝะฐ ะฒะตััะธะฝั ััะตะบะฐ). ะัะธ ะธะฝะธัะธะฐะปะธะทะฐัะธะธ ััะตะบ ัะบะฐะทัะฒะฐะตั ะฝะฐ ะฐะดัะตั ะฟะพัะปะตะดะฝะตะน ััะตะนะบะธ ะฟะฐะผััะธ + 1. ะกัะตะบ "ัะฐัััั" ะฒะฝะธะท, ะฟัััะผ ะดะตะบัะตะผะตะฝัะฐ esp-ัะตะณะธัััะฐ. ะัะธ ะฟะพะผะตัะตะฝะธะธ ะทะฝะฐัะตะฝะธั ะฒ ััะตะบ esp-ัะตะณะธััั ะดะตะบัะตะผะตะฝัะธััะตััั ะธ ะทะฝะฐัะตะฝะธะต ะบะปะฐะดัััั ะฒ ะฟะฐะผััั ะฟะพ ะฐะดัะตัั ะธะท ะฝะตะณะพ. ะัะธ ัะดะฐะปะตะฝะธะธ ะทะฝะฐัะตะฝะธั ะธะท ััะตะบะฐ, ะฒัะฟะพะปะฝัะตััั ะพะฑัะฐัะตะฝะธะต ะบ ะฟะฐะผััะธ ะฟะพ ะฐะดัะตัั ะธะท esp-ัะตะณะธัััะฐ ะธ ะตะณะพ ะฟะพะปัะตะดัััะธะน ะธะฝะบัะตะผะตะฝั.

ะ ััะพะน ะบะฐัะตะณะพัะธะธ ัะตะฐะปะธะทะพะฒะฐะฝั ัะปะตะดัััะธะต ะพะฟะตัะฐัะธะธ:
- PUSH - ะบะปะฐะดัั ะทะฝะฐัะตะฝะธะต ะฒ ััะตะบ, ะฐัะณัะผะตะฝัะพะผ ัะฒะปัะตััั ัะตะณะธััั ะธะปะธ immed-ะทะฝะฐัะตะฝะธะต.
- POP - ะดะพััะฐัั ะทะฝะฐัะตะฝะธั ะธะท ััะตะบะฐ ะธ ะบะปะฐะดัั ะตะณะพ ะฒ ัะตะณะธััั, ะฟะตัะตะดะฐะฝะฝัะน ะบะฐะบ ะฐัะณัะผะตะฝั
- CALL - ะฒัะทะพะฒ ะฟัะพัะตะดััั(ััะฝะบัะธะธ). ะะพะผะตัะฐะตั ะฒ ััะตะบ ัะตะบััะตะต ะทะฝะฐัะตะฝะธะต eip-ัะตะณะธัััะฐ ะธ ะทะฐะผะตะฝัะตั ะตะณะพ ะฐะดัะตัะพะผ, ะฟะตัะตะดะฐะฝะฝัะผ ะบะฐะบ ะฐัะณัะผะตะฝั, ัะตะผ ัะฐะผัะผ ะพัััะตััะฒะปัั ะฟะตัะตัะพะด ะฒ ัะตะปะพ ะฟัะพัะตะดััั
- RET - ะฒัะฟะพะปะฝัะตั ะฒะพะทะฒัะฐัะตะฝะธะต ะธะท ะฟัะพัะตะดััั. ะะพััะฐัั ะทะฝะฐัะตะฝะธะต ะธะท ััะตะบะฐ ะธ ะบะปะฐะดัั ะตะณะพ ะฒ eip. ะะต ะฟัะธะฝะธะผะฐะตั ะฐัะณัะผะตะฝัะพะฒ. ะญัะฐ ะพะฟะตัะฐัะธั ะฐะฝะฐะปะพะณะธัะฝะฐ ะฒัะทะพะฒั `pop eip`

## ะขัะฐะฝัะปััะพั
**ะัะพะดะฝัะต ะดะฐะฝะฝัะต**:
- ะััั ะบ ัะฐะนะปั ั ะธััะพะดะฝัะผ ะบะพะดะพะผ
- ะััั ะบ ัะฐะนะปั ะดะปั ัะฐะทะผะตัะตะฝะธั ัะตะทัะปััะฐัะฐ

**ะััะพะดะฝัะต ะดะฐะฝะฝัะต**:
- ะขัะฐะฝัะปะธัะพะฒะฐะฝะฝะฐั ะฟัะพะณัะฐะผะผะฐ, ัะฐะทะผะตััะฝะฝะฐั ะฒ ัะบะฐะทะฐะฝะฝะพะผ ัะฐะนะปะต

ะัะทะพะฒ ััะฐะฝัะปััะพัะฐ ะพัััะตััะฒะปัะตััั ัะปะตะดัััะธะผ ะพะฑัะฐะทะพะผ:  
`./translator <source_file> <target_file>`

ะขัะฐะฝัะปััะพั ัะฐะฑะพัะฐะตั ะฒ 2 ะฟัะพัะพะดะฐ:

ะ ะฟะตัะฒะพะผ ะฟัะพัะพะดะต ััะฐะฝัะปััะพั ัะฐัััะธััะฒะฐะตั ะฐะดัะตัะฐ ะฒัะตั ัะบะฐะทะฐะฝะฝัั ะผะตัะพะบ.

ะะพ ะฒัะพัะพะผ ะฟัะพัะพะดะต ััะฐะฝัะปััะพั ะพััััะตััะฒะปัะตั ัะตะฐะปัะฝัะน ะฟะตัะตะฒะพะด ะธะท ัะทัะบะฐ ะฒ ะผะฐัะธะฝะฝัะต ะธะฝััััะบัะธะธ, ะฟะพะดััะฐะฒะปัั ะฒะผะตััะพ ะพะฑัะฐัะตะฝะธะน ะบ ะผะตัะบะฐะผ ะธั ัะฐัััะธัะฐะฝะฝัะต ะฐะดัะตัะฐ.


## ะะพะดะตะปั ะฟัะพัะตััะพัะฐ
**ะัะพะดะฝัะต ะดะฐะฝะฝัะต**:
- ะััั ะบ ัะฐะนะปั ั ะฟัะพะณัะฐะผะผะพะน
- ะััั ะบ ัะฐะนะปั ั ะดะฐะฝะฝัะผะธ, ะบะพัะพััะต ะฒะฒะพะดัััั ะฒ ะฟัะพัะตััะพั (ัะตัะตะท ััััะพะนััะฒะพ ะฒ ะฟะพััะต 0)

**ะััะพะดะฝัะต ะดะฐะฝะฝัะต**:
- ะัะฒะพะด ะดะฐะฝะฝัั ะธะท ะฟัะพัะตััะพัะฐ (ัะตัะตะท ััััะพะนััะฒะพ ะฒ ะฟะพััะต 1)
- ะะฐะฝะฝัะต ะปะพะณะธัะพะฒะฐะฝะธั ัะพััะพัะฝะธั ัะตะณะธัััะพะฒ ะธ ัะปะฐะณะพะฒ ะฟัะพัะตััะพัะฐ

ะัะทะพะฒ ะฒะธัััะฐะปัะฝะพะน ะผะฐััะธะฝั ะพัััะตััะฒะปัะตััั ัะปะตะดัััะธะผ ะพะฑัะฐะทะพะผ:  
`./machine <code_file> <input_file>`

### ะกัะตะผะฐ Datapath
```
                    to Decoder
                  โฒ     โฒ     โฒ                       โfrom Decoder               โfrom Decoder    โฒto Decoder
                  โ     โ     โ                       โ                           โ                โ
                  โ     โ     โ                       โ                           โ                โ
                  โ     โ     โ                       โ                           โ                โ
                  โ     โ     โ                       โ                           โ                โ
                  โ     โ     โ                       โ                           โ                โ
                  โ     โ     โ                       โ โโโโโโโโโโโโโโโโโโ        โ                โ
                  โ     โ     โ          โโโโโโโโโโโโโโผโโค     Memory     โ    โโโโโผโโโโโ           โ
                  โ     โ     โ          โ            โ โ                โโโโโโคMem Addrโโโโ        โ
                  โ     โ     โ   sel โโโโผโโโ         โ โ                โ    โโโโโโโโโโ  โ        โ
                  โ     โ     โ   โโโโโบDEMUXโ         โ โ                โ                โ        โ
                  โ     โ     โ       โโฌโโฌโโฌโ         โ โ                โRD SIG          โ        โ
                  โ     โ     โ        โ โ โ          โ โ                โโโโโ            โ        โ
                  โ     โ     โโโโโโโโโโ โ โ          โ โ                โ                โ        โ
                  โ     โ                โ โ          โ โ                โ                โ        โ
                  โ     โ     โโโโโโโโโโโโ โ          โ โ                โWR SIG          โ        โ
                  โ     โ     โ            โ          โ โ                โโโโ             โ        โ
                  โ  โโโโดโโโโโโผโโโโโ       โ          โ โ                โ                โ        โ
to/from Ports     โ  โ  Registers  โ       โ          โ โ                โ   โโโโโโโโโโโโ โ        โ
โโโโโโโโโโโโโโโโโโโผโโโบ             โ   โโโโโผโโโโโโโโ  โ โ                โโโโโคMem In Bufโ โ        โ
                  โ  โ             โ   โMem Out Bufโ  โ โ                โ   โโโฒโโโโโโโโโ โ        โ
                  โ  โโโฒโโโโโโฌโโโโโโ   โโโโโโฌโโโโโโโ  โ โโโโโโโโโโโโโโโโโโ     โ          โ        โ
                  โ    โ     โ              โ         โ                        โ          โ        โ
                  โ    โ     โ โโโโโโโโโโโโโโค         โ                        โ          โ        โ
                  โ    โ     โ โ            โ         โ                        โ          โ        โ
                  โ    โ     โโโผโโโโโโโโโโโ โ โโโโโโโโโ                        โ          โ        โ
                  โ    โ     โ โ          โ โ โ                                โ          โ        โ
                  โ    โ selโโผโโผโ        โโผโโผโโผโsel                            โ          โ        โ
                  โ    โ โโโโบMUXโ        โ MUX โโโโ                            โ          โ        โ
                  โ    โ    โโโฌโโ        โโโฌโโโโ                               โ          โ        โ
                  โ    โ      โ            โ                                   โ          โ        โ
                  โ    โ    โโโผโโโโโโโโโโโโโผโโ                                 โ          โ        โ
                  โ    โ    โ      ALU       โ                                 โ          โ        โ
                  โ    โ    โ                โALU signals                      โ          โ        โ
                  โ    โ    โ                โโโโโโโโ                          โ          โ        โ
                  โ    โ    โ                โ                                 โ          โ        โ
                  โ    โ    โ                โ                                 โ          โ        โ
                  โ    โ    โโโโโโโโโฌโโโโโโโโโ                                 โ          โ        โ
                  โ    โ            โ                        โโโโโโโ           โ          โ        โ
                  โ    โ            โโโโโโโโโโโโโโโโโโโโโโโโโโบflagsโโโโโโโโโโโโโผโโโโโโโโโโโผโโโโโโโโโ
                  โ    โ            โ                        โโโโโโโ           โ          โ
                  โ    โ       โโโโโโผโโโโโsel                                  โ          โ
                  โ    โ       โ  DEMUX  โโโโ                                  โ          โ
                  โ    โ       โโโฌโโฌโโโฌโโฌโ                                     โ          โ
                  โ    โ         โ โ  โ โ                                      โ          โ
                  โ    โโโโโโโโโโโ โ  โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ          โ
                  โ                โ  โ                                                   โ
                  โโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะกัะตะผะฐ ControlUnit
```
                                                                         โโโโโโโโโโโโโ
                                                                         โ microcode โ
                                                                         โ decoder   โ
                                                                         โโโโโฌโโโโโโโฌโ
                                                                             โ      โ
                                                                             โ      โ
                                                                             โ      โ
                                                                             โ      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ        โ      โ
โ                            Decoder                                โ        โ      โ
โ                                                                   โ        โ      โ
โ                                                                   โ        โ      โ
โ                                                                   โ        โ      โ
โ                                                                   โSignals โ      โ
โ                        *ัััะฝะฐั ะผะฐะณะธั*                             โโโโโโโโโโ      โ
โ                                                                   โ               โ
โ                                                                   โ               โ
โ                           operand pipe                            โ               โ
โ                        โโโโโโโโโโโโโโโโโโโ                        โ               โ
โ                        โ                 โ                        โ               โ
โ        โโโโโโโโโโโโโโโโโดโโโ            โโโผโโโโโโโโโโโโโ           โ               โ
โ        โInstruction bufferโ            โOperand bufferโ           โ               โ
โ        โโโฒโโโโโโโโโโโโโโโโโ            โโโฒโโโโโโโโโโโฌโโ           โ               โ
โ          โ                               โ          โ             โ               โ
โ          โ                               โ          โ             โ               โ
โ          โ                               โ          โ             โโโโโโโโโโโโโโโโโค
โ          โ                               โ          โ             โ               โ
โ          โ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ          โ             โ               โ
โ          โ  โ                                       โ             โ               โ
โ         โโดโโโดโโ                                     โ             โ               โ
โ         โDEMUXโ                                     โ             โ flags         โ
โ         โโโฒโโโโ                                     โ             โโโโโโโโโโโ     โ
โ           โ                                         โ             โ         โ     โ
โโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโ         โ     โ
            โ                                         โ                       โ     โ
            โ                                         โ                       โ     โ
            โ                                         โ                       โ     โ
            โ                                         โ                       โ     โ
            โ                                         โ                       โ     โ
            โ                                         โ                       โ     โ
            โfrom ALU DEMUX                           โผto right ALU MUX       โ     โ
โโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ         โ     โ
โ                              Datapath                             โ         โ     โ
โ                                                                   โโโโโโโโโโโ     โ
โ                                                                   โ               โ
โ                                                                   โ               โ
โ                                                                   โโโโโโโโโโโโโโโโโ
โ                                                                   โ Signals
โ                                                                   โ
โ                                                                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```



## ะขะตััะธัะพะฒะฐะฝะธะต
### ะะฝัะตะณัะฐัะธะพะฝะฝะพะต ัะตััะธัะพะฒะฐะฝะธะต
ะะปั ะธะฝัะตะณัะฐัะธะพะฝะฝะพะณะพ ัะตััะธัะพะฒะฐะฝะธั ะธัะฟะพะปัะทัะตััั ะฑะธะฑะปะธะพัะตะบะฐ [insta](https://crates.io/crates/insta), ะฟัะตะดะพััะฐะฒะปัััะธะน ะฒะพะทะผะพะถะฝะพััั ัะตััะธัะพะฒะฐะฝะธั ะฝะฐ ะพัะฝะพะฒะต ัะฝะฐะฟัะพัะพะฒ.  
ะฏ ััะธัะฐั ััั ะฑะธะฑะปะธะพัะตะบั ะฝะฐะธะปัััะธะผ ะฐะฝะฐะปะพะณะพะผ golden-ัะตััะพะฒ ะฒ ัะฐะผะบะฐั Rust'ะฐ. ะขะตัะฝะธัะตัะบะธ, ัะฝะฐะฟัะพัั ััะฐะฝัั ะฒ ัะตะฑะต ัะพะปัะบะพ ัะตะทัะปััะฐัั, ะฐ ะฝะต ะฒัะพะดะฝัะต ะดะฐะฝะฝัะต, ะฝะพ ััะพ ะธัะฟัะฐะฒะปัะตััั ะฟัะพััะพ ัััะฝะพะน ะพะฑัะฐะฑะพัะบะพะน ัะฐะนะปะพะฒ ะฒัะพะดะฝัั ะดะฐะฝะฝัั, ะฝะฐัััะพะตะฝะฝะพะน ะผะฝะพั.

ะ ะดะธัะตะบัะพัะธะธ [inputs](./tests/inputs/) ัะฐะทะผะตัะฐัััั ะฒัะพะดะฝัะต ะดะฐะฝะฝัะต ะดะปั ะพัะดะตะปัะฝัั ัะตััะพะฒ. ะะฐะถะดัะน yml ัะฐะนะป ะฒ ััะพะน ะดะธัะตะบัะพัะธะธ ัะพะดะตัะถะธั ะฐััะตะผะฑะปะตั-ะบะพะด ะดะปั ััะฐะฝัะปััะพัะฐ ะธ ะฒัะพะดะฝัะต ะดะฐะฝะฝัะต ะดะปั ะฒะธัััะฐะปัะฝะพะน ะผะฐัะธะฝั. ะะฝัะตะณัะฐัะธะพะฝะฝัะน ัะตัั ัะพะฒะตััะฐะตั ัะธะบะป ะพะฑัะฐะฑะพัะบะธ ะพัะดะตะปัะฝะพ ะดะปั ะบะฐะถะดะพะณะพ ะธะท ััะธั ัะฐะนะปะพะฒ.

ะะปั ะบะฐะถะดะพะณะพ ัะฐะนะปะฐ ัะพะทะดะฐัััั ะฝะฐะฑะพั ะฒัะตะผะตะฝะฝัั ัะฐะนะปะพะฒ ะดะปั ะฒัะพะดะฝัั ะดะฐะฝะฝัั ััะฐะฝัะปััะพัะฐ ะธ ะผะฐัะธะฝั ะธ ัะฐะนะปะฐ ั ะผะฐัะธะฝะฝัะผ ะบะพะดะพะผ. ะัะฒะพะดั ะฒ stdout (ะฒัะฒะพะด ะฒะธััะฐัะปัะฝะพะน ะผะฐัะธะฝั) ะธ stderr (ะดะฐะฝะฝัะต ะปะพะณะธัะพะฒะฐะฝะธั) ัะฐะบะถะต ะทะฐัะฒะฐััะฒะฐัััั. ะะพ ะพะบะพะฝัะฐะฝะธั ัะฐะฑะพัั ััะฐะฝัะปััะพัะฐ ะธ ะผะฐัะธะฝั (ะฝะต ะฒะฐะถะฝะพ, ััะฟะตัะฝะพะน ะธะปะธ ะฝะตั), ัะพะทะดะฐัััั ัะฟะตัะธะฐะปัะฝัะน ัะฝะฐะฟัะพั-ัะฐะนะป.

ะ ะทะฐะฒะธัะธะผะพััะธ ะพั ะฝะฐัััะพะนะบะธ ััะตะนะผะพะฒะพัะบะฐ ะดะปั ัะตััะธัะพะฒะฐะฝะธั, ะฝะพะฒัะต ัะฝะฐะฟัะพั-ัะฐะนะปั ะผะพะณัั:
- ะผะณะฝะพะฒะตะฝะฝะพ ะทะฐะผะตะฝะธัั ััะฐััะต
- ะพัะฟัะฐะฒะธัััั ะฝะฐ review diff'ะฐ ะฟัะพะณัะฐะผะผะธััะพะผ
- ัะดะฐะปะธัััั, ะตัะปะธ ะพะฝะธ ัะพะฒะฟะฐะดะฐัั ัะพ ััะฐััะผะธ (ะฝะตั ะธะทะผะตะฝะตะฝะธะน)
- "ะฟัะพะฒะฐะปะธัั" ัะตัั, ะตัะปะธ ัััะตััะฒัะตั ัะฐะทะฝะธัะฐ ัะพ ััะฐััะผะธ ัะฝะฐะฟัะพั-ัะฐะนะปะฐะผะธ
- ะธ ั.ะด. (ะปัััะต ะฟัะพ ััะพ ะพะฟะธััะฒะฐะตััั ะฒ ัะฐะผะบะฐั ะดะพะบัะผะตะฝัะฐัะธะธ ัะฐะผะพะณะพ ััะตะนะผะฒะพัะบะฐ)

### CI
[Workflow](./.github/workflows/rust.yml) ะฝะฐัััะพะตะฝ ะดะปั Github Actions, ะธ ะฟัะพะธะทะฒะพะดะธั ัะปะตะดัััะธะธะต ะดะตะนััะฒะธั:
- ะัะพะฒะตัะบะฐ ัะพัะผะฐัะธัะพะฒะฐะฝะธั
- ะัะพะฒะตัะบะฐ ะปะธะฝัะตัะพะผ
- ะขะตััะธัะพะฒะฐะฝะธะต
- ะกะฑะพัะบะฐ

CI ะฝะฐัััะพะตะฝ ะดะปั ัะฐะฑะพัั ะฟัะธ ะฒัะฟะพะปะฝะตะฝะธะธ push ะธ pull request ะฝะฐ ะฒะตัะบะฐั master ะธ workflow

### ะขะตััะพะฒัะต ะฐััะตะผะฑะปะตั-ะฟัะพะณัะฐะผะผั
#### hello
[input-file](./tests/inputs/hello.yml)

[snapshot-file](./tests/snapshots/integration__test@hello.yml.snap)
```asm
  hello: word "Hello, world!"

  start: 
    mov eax, hello
    call print_string
    exit

  print_string:     ;EAX - ัะบะฐะทะฐัะตะปั ะฝะฐ ะฝะฐัะฐะปะพ ัััะพะบะธ (ัะฐะทะผะตั)
    mov edx, eax    ;ะธัะฟะพะปัะทัะตะผ edx ะฒ  ะบะฐัะตััะฒะต ัะบะฐะทะฐัะตะปั ะฝะฐ ัะตะบััะธะน ะฝะฐะฑะพั ัะธะผะฒะพะปะพะฒ
    mov ecx, [eax]  ;ัะธัะฐะตะผ ะดะปะธะฝั ัััะพะบะธ ะฒ ecx
    jz print_string_end ;ะตัะปะธ ะดะปะธะฝะฐ ะฝัะปะตะฒะฐั - ะทะฐะฒะตััะฐะตะผ ัะฐะฑะพัั

  print_string_main_loop:
    inc edx         ;ะฟะตัะตัะพะดะธะผ ะบ ัะปะตะดัััะตะน ััะตะนะบะต ั ัะธะผะฒะพะปะฐะผะธ
    mov eax, [edx]  ;ัะธัะฐะตะผ ะฝะฐะฑะพั ัะธะผะฒะพะปะพะฒ ะฒ eax
    mov ebx, 4      ;ะธัะฟะพะปัะทัะตะผ ebx ะบะฐะบ ัััััะธะบ ัะธะผะฒะพะปะพะฒ ะฒ ะพะดะฝะพะน ััะตะนะบะต

  print_string_word_loop:
    out 1           ;ะฒัะฒะพะดะธะผ ัะธะผะฒะพะป

    dec ecx         ;ัะผะตะฝััะฐะตะผ ะพััะฐะฒััััั ะดะปะธะฝั ัััะพะบะธ. ะัะปะธ ัััะพะบะฐ ะบะพะฝัะธะปะฐัั - ะทะฐะฒะตััะฐะตะผ ัะฐะฑะพัั
    jz print_string_end

    dec ebx         ;ัะผะตะฝััะฐะตะผ ัะธัะปะพ ะพััะฐะฒัะธััั ัะธะผะฒะพะปะพะฒ ะฒ ัะตะบััะตะน ััะตะนะบะต. ะัะปะธ ะบะพะฝัะธะปะธัั - ะฟะตัะตัะพะดะธะผ ะบ ัะปะตะดัััะตะน
    jz print_string_main_loop

    shr eax, 8      ;ัะดะฒะธะณะฐะตะผ eax ะดะปั ะฟะพะปััะตะฝะธั ัะปะตะดัััะตะณะพ ัะธะผะฒะพะปะฐ ะฒ ะผะปะฐะดัะตะผ ะฑะฐะนัะต
    jmp print_string_word_loop

  print_string_end:
    ret
```

#### cat
[input-file](./tests/inputs/cat.yml)

[snapshot-file](./tests/snapshots/integration__test@cat.yml.snap)
```asm
  start: 
    in 0
    cmp eax, 0  ;ะตัะปะธ ะฒัััะตัะฐะตะผ NULL - ะทะฐะบะฐะฝัะธะฒะฐะตะผ ะฟัะพะณัะฐะผะผั
    jz end
    out 1
    jmp start
  end:
    exit
```

#### hello_user_name
[input-file](./tests/inputs/hello_user_name.yml)

[snapshot-file](./tests/snapshots/integration__test@hello_user_name.yml.snap)
```asm
  prompt: word "What is your name?"
  hello_start: word "Hello, "
  hello_end: word "!"
  username_buf: word 0 word 0 word 0 word 0

  start: 
    mov eax, prompt
    call print_string
    call print_newline

    mov eax, username_buf
    call read_string

    mov eax, hello_start
    call print_string

    mov eax, username_buf
    call print_string

    mov eax, hello_end
    call print_string

    exit


  read_string:      ;EAX - ัะบะฐะทะฐัะตะปั ะฝะฐ ะฑััะตั
    push eax        ;ัะพััะฐะฝัะตะผ ัะบะฐะทะฐัะตะปั ะฝะฐ ะฝะฐัะฐะปะพ ัััะพะบะธ (ััะตะนะบะฐ ะดะปั ะดะปะธะฝั)
    mov edx, eax
    mov ecx, 0      ;ะธัะฟะพะปัะทัะตะผ ecx ะดะปั ััะฐะฝะตะฝะธั ะดะปะธะฝั ะฟัะพัะธัะฐะฝะฝะพะน ัััะพะบะธ

  read_string_main_loop:
    inc edx         ;ัะผะตััะตะผ edx ะฝะฐ ััะตะนะบั ะดะปั ัะปะตะดัััะตะน ัะตัะฒััะบะธ ัะธะผะฒะพะปะพะฒ
    mov ebx, 0      ;ัะฑัะฐััะฒะฐะตะผ ebx - ะธัะฟะพะปัะทัะตะผ ะตะณะพ ะบะฐะบ ะธะฝะดะตะบั ะฟะพ ะฑะฐะนัะฐะผ ััะตะนะบะธ (0 - 3)

  read_string_word_loop:
    mov eax, 0      ;ัะธัะฐะตะผ ัะธะผะฒะพะป
    in 0
    cmp eax, 0      ;ะตัะปะธ NULL - ะพะบะฐะฝัะธะฒะฐะตะผ ััะตะฝะธะต
    jz read_string_end
    inc ecx         ;ัะฒะตะปะธัะธะฒะฐะตะผ ะดะปะธะฝั ัััะพะบะธ
    push ebx        ;ัะพััะฐะฝัะตะผ ัะตะบััะธะน ะธะฝะดะตะบั ะฒ ััะตะนะบะต
  read_string_shift_loop:
    cmp ebx, 0      ;ะตัะปะธ ะธะฝะดะตะบั ัะฐะฒะตะฝ ะฝัะปั - ัะพััะฐะฝัะตะผ ัะธะผะฒะพะป ะฒ ััะตะนะบั
    jz read_string_word_stuff
    shl eax, 8      ;ะธะฝะฐัะต - ัะผะตััะตะผ ัะธะผะฒะพะป ะฒะปะตะฒะพ ะฝะฐ ะพะดะฝั ะฟะพะทะธัะธั
    dec ebx         ;ะธ ัะผะตะฝััะฐะตะผ ะธะฝะดะตะบั "ะพััััะฟะฐ"
    jmp read_string_shift_loop
  read_string_word_stuff:
    add [edx], eax  ;ัะพััะฐะฝัะตะผ ัะธะผะฒะพะป ะฒ ััะตะนะบั
    pop ebx         ;ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐะตะผ ะธะฝะดะตะบั ััะพะณะพ ัะธะผะฒะพะปะฐ
    inc ebx         ;ะฟะพะดะณะพัะฐะฒะปะธะฒะฐะตะผ ะธะฝะดะตะบั ะดะปั ัะปะตะดัััะตะณะพ ัะธะผะฒะพะปะฐ
    cmp ebx, 4      ;ะตัะปะธ ะผะตััะพ ะฒ ััะตะนะบะต ะบะพะฝัะธะปะพัั - ะฟะตัะตัะพะดะธะผ ะบ ัะปะตะดัััะตะน
    jz read_string_main_loop
    jmp read_string_word_loop

  read_string_end:
    pop eax         ;ะฒะพัััะฐะฝะฐะฒะปะธะฒะฐะตะผ ัะบะฐะทะฐัะตะปั ะฝะฐ ะฝะฐัะฐะปะพ ัััะพะบะธ
    mov [eax], ecx  ;ะทะฐะฟะธััะฒะฐะตะผ ัะฐะทะผะตั ัััะพะบะธ
    ret


  print_newline:
    mov eax, 10
    out 1
    ret


  print_string:     ;EAX - ัะบะฐะทะฐัะตะปั ะฝะฐ ะฝะฐัะฐะปะพ ัััะพะบะธ (ัะฐะทะผะตั)
    mov edx, eax    ;ะธัะฟะพะปัะทัะตะผ edx ะฒ  ะบะฐัะตััะฒะต ัะบะฐะทะฐัะตะปั ะฝะฐ ัะตะบััะธะน ะฝะฐะฑะพั ัะธะผะฒะพะปะพะฒ
    mov ecx, [eax]  ;ัะธัะฐะตะผ ะดะปะธะฝั ัััะพะบะธ ะฒ ecx
    jz print_string_end ;ะตัะปะธ ะดะปะธะฝะฐ ะฝัะปะตะฒะฐั - ะทะฐะฒะตััะฐะตะผ ัะฐะฑะพัั

  print_string_main_loop:
    inc edx         ;ะฟะตัะตัะพะดะธะผ ะบ ัะปะตะดัััะตะน ััะตะนะบะต ั ัะธะผะฒะพะปะฐะผะธ
    mov eax, [edx]  ;ัะธัะฐะตะผ ะฝะฐะฑะพั ัะธะผะฒะพะปะพะฒ ะฒ eax
    mov ebx, 4      ;ะธัะฟะพะปัะทัะตะผ ebx ะบะฐะบ ัััััะธะบ ัะธะผะฒะพะปะพะฒ ะฒ ะพะดะฝะพะน ััะตะนะบะต

  print_string_word_loop:
    out 1           ;ะฒัะฒะพะดะธะผ ัะธะผะฒะพะป

    dec ecx         ;ัะผะตะฝััะฐะตะผ ะพััะฐะฒััััั ะดะปะธะฝั ัััะพะบะธ. ะัะปะธ ัััะพะบะฐ ะบะพะฝัะธะปะฐัั - ะทะฐะฒะตััะฐะตะผ ัะฐะฑะพัั
    jz print_string_end

    dec ebx         ;ัะผะตะฝััะฐะตะผ ัะธัะปะพ ะพััะฐะฒัะธััั ัะธะผะฒะพะปะพะฒ ะฒ ัะตะบััะตะน ััะตะนะบะต. ะัะปะธ ะบะพะฝัะธะปะธัั - ะฟะตัะตัะพะดะธะผ ะบ ัะปะตะดัััะตะน
    jz print_string_main_loop

    shr eax, 8      ;ัะดะฒะธะณะฐะตะผ eax ะดะปั ะฟะพะปััะตะฝะธั ัะปะตะดัััะตะณะพ ัะธะผะฒะพะปะฐ ะฒ ะผะปะฐะดัะตะผ ะฑะฐะนัะต
    jmp print_string_word_loop

  print_string_end:
    ret
```

#### prob2
[input-file](./tests/inputs/prob2.yml)

[snapshot-file](./tests/snapshots/integration__test@prob2.yml.snap)
```asm
  num: word 1         ;ะฑััะตั ะดะปั ะฟัะตะดะฟะพัะปะตะดะฝะตะณะพ ัะธัะปะฐ ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััะธ
  result: word 2      ;ะฑััะตั ะดะปั ัะตะทัะปััะฐัะฐ

  start:
    mov ecx, 3        ;ัััััะธะบ ะดะพ ัะปะตะดัััะตะณะพ ัััะฝะพะณะพ ัะธัะปะฐ
    mov eax, 2        ;ะฟะพัะปะตะดะฝะตะต ัะธัะปะพ ะฒ ะฟะพัะปะตะดะพะฒะฐัะตะปัะฝะพััะธ
  loop:
    mov edx, eax      ;ัะพััะฐะฝัะตะผ ะฟะพัะปะตะดะฝะตะต ัะธัะปะพ
    add eax, [num]    ;ัะฐัััะธััะฒะฐะตะผ ัะปะตะดัััะตะต ัะธัะปะพ
    mov [num], edx    ;ะพะฑะฝะพะฒะปัะตะผ ะฟัะตะดะฟะพัะปะตะดะฝะตะต ัะธัะปะพ
    dec ecx           ;ัะผะตะฝััะฐะตะผ ัััััะธะบ. ะัะปะธ ะดะพ ัััะฝะพะณะพ ัะธัะปะฐ ะตัั ะฝะต ะดะพัะปะธ - ะฟะพะฒัะพััะตะผ ะฟัะพัะตัั
    jnz loop
    mov ecx, 3        ;ัะฑัะฐััะฒะฐะตะผ ัััััะธะบ
    cmp eax, 4000000  ;ะตัะปะธ ะดะพััะธะณะปะธ ะฟัะตะดะตะปะฐ - ะทะฐะฒะตััะฐะตะผ ัะฐะฑะพัั
    jns end
    add [result], eax ;ะพะฑะฝะพะฒะปัะตะผ ัะตะทัะปััะฐั
    jmp loop

  end:
    mov eax, [result]
    call print_uint
    exit


  print_uint:       ;EAX - ัะธัะปะพ
    mov ebx, 10     ;ะทะฐะฟะธััะฒะฐะตะผ ะดะตะปะธัะตะปั ะฒ ebx
    mov ecx, esp    ;ัะพััะฐะฝัะตะผ ัะตะบัััั ะฟะพะทะธัะธั ะฒ ัััะบะต

  print_uint_loop:
    dec esp         ;ะฒัะดะตะปัะตะผ ะผะตััะพ ะฟะพะด ัะธะผะฒะพะป
    mov edx, 0      ;ะพัะธัะฐะตะผ edx
    div             ;ะดะตะปะธะผ eax ะฝะฐ ebx: ะฒ eax - ัะฐััะฝะพะต, ะฒ edx - ะพััะฐัะพะบ
    add edx, 48     ;"ัะผะตัะฐะตะผ" ะพััะฐัะพะบ ะดะปั ะฟะพะปััะตะฝะธั ASCII-ัะธััั
    mov [esp], edx  ;ัะพััะฐะฝัะตะผ ะฟะพะปััะธะฒัะธะนัั ัะธะผะฒะพะป
    cmp eax, 0      ;ะตัะปะธ ะตัั ะพััะฐะปะธัั ัะฐะทััะดั ัะธัะปะฐ - ะฟะพะฒัะพััะตะผ ะฟัะพัะตัั
    jnz print_uint_loop
  print_uint_print:
    mov eax, [esp]  ;ัะธัะฐะตะผ ััะฐััะธะน ะฝะตะฒัะฒะตะดะตะฝะฝัะน ัะธะผะฒะพะป
    out 1           ;ะฒัะฒะพะดะธะผ ะตะณะพ
    inc esp         ;ะพัะฒะพะฑะพะถะดะฐะตะผ ะฟะฐะผััั ั ะฒัะฒะตะดะตะฝะฝัะผ ัะธะผะฒะพะปะพะผ
    cmp esp, ecx    ;ะตัะปะธ ัะธะผะฒะพะปั ะฝะต ะบะพะฝัะธะปะธัั - ะฟะพะฒัะพััะตะผ ะฟัะพัะตัั
    jnz print_uint_print
  print_uint_end:
    ret
```

| ะคะะ | <ะฐะปะณ> | <LoC> | <code ะฑะฐะนั> | <code ะธะฝััั.> | <ะธะฝััั.> | <ัะฐะบั.> | <ะฒะฐัะธะฐะฝั> |
|-|-|-|-|-|-|-|-|
ะฅะฐะนะบะธะฝ ะะปะตะณ ะะณะพัะตะฒะธั | hello | 91 | 396 | 99 | 341 | 2658 | asm \| cisc \| neum \| hw \| tick \| struct \| stream \| port \| pstr \| prob2 \| \[4\]char |
ะฅะฐะนะบะธะฝ ะะปะตะณ ะะณะพัะตะฒะธั | cat | 8 | 36 | 9 | 39 | 301 | asm \| cisc \| neum \| hw \| tick \| struct \| stream \| port \| pstr \| prob2 \| \[4\]char |
ะฅะฐะนะบะธะฝ ะะปะตะณ ะะณะพัะตะฒะธั | prob2 | 44 | 200 | 50 | 310 | 4932 (ะธะท ะฝะธั ~2000 ะฝะฐ ัะฐะผ ะฐะปะณะพัะธัะผ, ะพััะฐะปัะฝะพะต ะดะปั ะฒัะฒะพะดะฐ ัะตะทัะปััะฐัะฐ) | asm \| cisc \| neum \| hw \| tick \| struct \| stream \| port \| pstr \| prob2 \| \[4\]char |